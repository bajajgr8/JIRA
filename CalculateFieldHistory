import com.atlassian.jira.component.ComponentAccessor
import com.atlassian.jira.issue.changehistory.ChangeHistoryManager
import java.sql.Timestamp

def issueManager = ComponentAccessor.getIssueManager()
def issue = issueManager.getIssueObject("IssueNumber")
ChangeHistoryManager changeHistoryManager = ComponentAccessor.getChangeHistoryManager()
List changes = changeHistoryManager.getChangeItemsForField(issue, "FieldName")
Timestamp currentTime = new Timestamp(System.currentTimeMillis())
int daysSinceLastChange = currentTime - changes[changes.size()-1].getCreated()
return changes.toString()

-----------------------------
def status1="Blocked"

List<Long> rt1 = [0L]
changeHistoryManager.getChangeItemsForField (issue, "blocked").reverse().each {ChangeItemBean item ->

def timeDiff = System.currentTimeMillis() - item.created.getTime()
if (item.fromString == status1) {
rt1 << -timeDiff
}
if (item.toString == status1){
rt1 << timeDiff
}

}

def status1Time = DateUtils.getDurationString(Math.round((rt1.sum().toString().toDouble() / 1000) as Double)) ?: "0m" as String
return " Workflow Status = " + status1Time
